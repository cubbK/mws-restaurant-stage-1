class DBHelper{static get DATABASE_URL(){const port=1337;return`http://localhost:${port}/restaurants`}static async fetchRestaurants(){const restaurants=await fetch(DBHelper.DATABASE_URL);const json=await restaurants.json();return json}static async fetchRestaurantById(id){const restaurants=await DBHelper.fetchRestaurants();const restaurant=restaurants.find(r=>r.id==id);return restaurant}static async fetchReviewsByRestaurantId(id){const allReviews=await DBHelper.fetchReviews();const reviews=allReviews.filter(review=>review.restaurant_id=id);return reviews}static async fetchReviews(){const reviews=await fetch(`http://localhost:1337/reviews/`);const reviewsData=await reviews.json();return reviewsData}static async fetchRestaurantByCuisine(cuisine,callback){const restaurants=await DBHelper.fetchRestaurants();const results=restaurants.filter(r=>r.cuisine_type==cuisine);callback(null,results);return results}static async fetchRestaurantByNeighborhood(neighborhood,callback){const restaurants=await DBHelper.fetchRestaurants();const results=restaurants.filter(r=>r.neighborhood==neighborhood);callback(null,results);return results}static async fetchRestaurantByCuisineAndNeighborhood(cuisine,neighborhood,callback){const restaurants=await DBHelper.fetchRestaurants();let results=restaurants;if(cuisine!="all"){results=results.filter(r=>r.cuisine_type==cuisine)}if(neighborhood!="all"){results=results.filter(r=>r.neighborhood==neighborhood)}callback(null,results);return results}static async fetchNeighborhoods(callback){const restaurants=await DBHelper.fetchRestaurants();const neighborhoods=restaurants.map((v,i)=>restaurants[i].neighborhood);const uniqueNeighborhoods=neighborhoods.filter((v,i)=>neighborhoods.indexOf(v)==i);callback(null,uniqueNeighborhoods);return uniqueNeighborhoods}static async fetchCuisines(callback){const restaurants=await DBHelper.fetchRestaurants();const cuisines=restaurants.map((v,i)=>restaurants[i].cuisine_type);const uniqueCuisines=cuisines.filter((v,i)=>cuisines.indexOf(v)==i);callback(null,uniqueCuisines);return uniqueCuisines}static urlForRestaurant(restaurant){return`./restaurant.html?id=${restaurant.id}`}static imageUrlForRestaurant(restaurant,size){return size?`/img/${size}/${restaurant.photograph}.jpg`:`/img/webp/${restaurant.photograph}.webp`}static mapMarkerForRestaurant(restaurant,map){const marker=new google.maps.Marker({position:restaurant.latlng,title:restaurant.name,url:DBHelper.urlForRestaurant(restaurant),map:map,animation:google.maps.Animation.DROP});return marker}static updateFavoriteRestaurant(toFavorite,restaurantId){const DBOpenRequest=indexedDB.open("RestaurantsDB",1);DBOpenRequest.onsuccess=(event=>{var db=event.target.result;var objectStore=db.transaction(`restaurants`,"readwrite").objectStore(`restaurants`);var restaurantsRequest=objectStore.getAll();restaurantsRequest.onsuccess=function(){const restaurants=restaurantsRequest.result;const neededRestaurant=restaurants.filter(restaurant=>restaurant.id==restaurantId)[0];neededRestaurant.is_favorite=toFavorite;objectStore.put(neededRestaurant)}})}}